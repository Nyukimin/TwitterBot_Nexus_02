# 自動実行バッチファイル (`run_bot.bat`) の設定と使い方

このドキュメントは、`run_bot.bat` を使用してTwitter自動返信ボットをWindowsのタスクスケジューラで定期実行する方法について説明します。

---

## 1. `run_bot.bat` の概要

`run_bot.bat` は、以下の処理を自動で行うためのバッチファイルです。

1.  **Conda環境のアクティベート**: `TwitterReplyEnv` 環境を有効にします。
2.  **メインスクリプトの実行**: `reply_bot/main.py` を `--live-run` モード（本番モード）で実行します。
3.  **ログの記録**: 実行結果（成功・エラー問わず）を `log/task_scheduler_runs.log` ファイルに日時と共に追記します。タスクが正しく実行されたか、エラーが発生していないかを後から確認できます。

**注意**: このバッチファイルを実行すると、実際にX（旧Twitter）への「いいね」や返信投稿が行われます。

---

## 2. Windows タスクスケジューラでの設定方法

以下の手順で、`run_bot.bat` を2時間ごとに自動実行するタスクを作成します。

1.  **タスクスケジューラを開く**
    - `Windowsキー` を押し、「`タスク スケジューラ`」と入力して開きます。

2.  **基本タスクの作成**
    - 右側の「操作」パネルから「**基本タスクの作成...**」をクリックします。

3.  **タスクの作成ウィザード**
    - **名前**: `Twitter Reply Bot` など、分かりやすい名前を付けます。
    - **トリガー**: 「**毎日**」を選択します。
    - **毎日の設定**: 開始日時はそのままで、「間隔: 1 日」で次へ進みます。
    - **操作**: 「**プログラムの開始**」を選択します。
    - **プログラムの開始**:
        - 「プログラム/スクリプト」に `C:\GenerativeAI\Twitter_reply\run_bot.bat` を指定します。
    - **完了**: 最後に「**[完了]をクリックしたときに、このタスクの[プロパティ]ダイアログを開く**」にチェックを入れて、「完了」をクリックします。

4.  **プロパティでの詳細設定**
    - プロパティ画面が開いたら、以下の設定を変更します。
    - **[全般] タブ**:
        - `◎ ユーザーがログオンしているかどうかにかかわらず実行する` を選択します。 (PCロック中でも実行するため)
        - `☐ 最上位の特権で実行する` にチェックを入れます。（推奨）
    - **[トリガー] タブ**:
        - トリガーを選択し、「**編集**」ボタンをクリックします。
        - `☑ 繰り返し間隔:` にチェックを入れ、「**2 時間**」を選択します。
        - `継続時間:` は「**無期限**」を選択します。
        - 「OK」をクリックします。
    - **[設定] タブ**:
        - `☑ タスクを停止するまでの時間:` にチェックを入れ、「**1 時間**」などに設定しておくと、予期せぬトラブルで処理が長引いた場合に強制終了できます。
    - 「OK」をクリックしてプロパティを閉じます。Windowsのパスワードを求められたら入力してください。

以上で設定は完了です。

---

## 3. 実行ログの確認方法

タスクが正常に実行されているか確認するには、プロジェクト内の `log/task_scheduler_runs.log` ファイルを開いてください。
バッチが実行されるたびに、開始と終了のタイムスタンプが記録されます。

```
[20230101_100000] Running bot...
(ここにPythonスクリプトの出力が表示されます)
[20230101_100500] Bot run finished.

[20230101_120000] Running bot...
(ここにPythonスクリプトの出力が表示されます)
[20230101_120500] Bot run finished.
```
エラーが発生した場合も、このファイルにエラーメッセージが出力されます。 